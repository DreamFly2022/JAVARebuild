# 不断优化升级自定义的RPC框架

[toc]

## 一、RPC框架的关键点

- 本地和服务器端都需要实体类和接口定义；
- 代理
- 序列化
- 网络传输
- 查找实现类

## 二、V1版：RPC脚手架

项目：[myrpcfxpro01](https://github.com/hefrankeleyn/JAVARebuild/tree/main/projects/myrpcfxpro01)，分为三个部分：`rpcfx-api`、`rpcfx-client`、`rpcfx-server`。

（1）[`rpcfx-api`](https://github.com/hefrankeleyn/JAVARebuild/tree/main/projects/myrpcfxpro01/rpcfx-api) 

- 封装了请求对象类[RpcfxRequest](https://github.com/hefrankeleyn/JAVARebuild/blob/main/projects/myrpcfxpro01/rpcfx-api/src/main/java/com/hef/rpcfx/api/RpcfxRequest.java)和响应的返回值对象类[RpcfxResponse](https://github.com/hefrankeleyn/JAVARebuild/blob/main/projects/myrpcfxpro01/rpcfx-api/src/main/java/com/hef/rpcfx/api/RpcfxResponse.java)；
- 定义了本地（client端）和远程（server端）都需要的POJO实体类和接口类，例如：实体类[User](https://github.com/hefrankeleyn/JAVARebuild/blob/main/projects/myrpcfxpro01/rpcfx-api/src/main/java/com/hef/rpcfx/api/User.java)、接口类[UserService](https://github.com/hefrankeleyn/JAVARebuild/blob/main/projects/myrpcfxpro01/rpcfx-api/src/main/java/com/hef/rpcfx/api/UserService.java)；

（2）[`rpcfx-client`](https://github.com/hefrankeleyn/JAVARebuild/tree/main/projects/myrpcfxpro01/rpcfx-client)

- 定义的[`Rpcfx`](https://github.com/hefrankeleyn/JAVARebuild/blob/main/projects/myrpcfxpro01/rpcfx-client/src/main/java/com/hef/rpcfx/client/Rpcfx.java)类为核心，通过动态代理创建出远程服务的对象；
- 动态代理中，通过`OkHttpClient`请求远程服务；
- 在[`RpcfxClientApplication`](https://github.com/hefrankeleyn/JAVARebuild/blob/main/projects/myrpcfxpro01/rpcfx-client/src/main/java/com/hef/rpcfx/client/RpcfxClientApplication.java)中测试，通过运行main方法，想调用本地方法一样调用远程服务的功能；

（3）[`rpcfx-server`](https://github.com/hefrankeleyn/JAVARebuild/tree/main/projects/myrpcfxpro01/rpcfx-server)

- [`RpcfxServerApplication`](https://github.com/hefrankeleyn/JAVARebuild/blob/main/projects/myrpcfxpro01/rpcfx-server/src/main/java/com/hef/rpcfx/server/RpcfxServerApplication.java)中通过Spring容器查找实现类，通过反射调用实现类的方法；
- [`UserServiceImpl`](https://github.com/hefrankeleyn/JAVARebuild/blob/main/projects/myrpcfxpro01/rpcfx-server/src/main/java/com/hef/rpcfx/server/UserServiceImpl.java)为具体的实现类；

## 三、V2版：RPC框架

项目：[myrpcfxpro02](https://github.com/hefrankeleyn/JAVARebuild/tree/main/projects/myrpcfxpro02)，重构升级为RPC框架。





